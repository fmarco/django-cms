{% load i18n l10n cms_tags %}
{% load url from future %}

<div class="cms_draggable cms_draggable-{{ plugin.pk|unlocalize }}{% if plugin.disable_child_plugins %} cms_draggable-disabled{% endif %}">
	<div class="cms_dragitem cms_dragitem-handler{% if plugin.child_plugin_instances %} cms_dragitem-collapsable{% endif %}">
		{% language request.toolbar.toolbar_language %}
		<div class="cms_switcher"></div>
		<div class="cms_submenu">
			<div class="cms_submenu-dropdown">
				<div class="cms_submenu-item cms_submenu-item-title"><span>{% trans "Settings" %}</span></div>
				{% plugin_child_classes plugin %}
			</div>
		</div>
		{% if plugin.child_plugin_instances %}
		<div class="cms_child-plugins">
			<div>
				<h2>{% trans "Add plugin" %}</h2>
				<input type="text" name="subject" class="quicksearch"/>
				{% plugin_child_classes plugin %}
				<a href="#" data-rel="close">{% trans "Cancel" %}</a>
			</div>
		</div>
		{% endif %}
		{% if show_language %}<span class="cms_submenu-lang">{{ plugin.language }}</span>{% endif %}
		<span class="cms_dragitem-text"><strong>{{ plugin.get_plugin_name }}</strong> {{ plugin.get_short_description }}</span>
        <div class='cms_draggable_toolbar'>
            {% if not plugin.disable_child_plugins %}
            <a data-rel="add" data-tooltip="{% trans "Add plugin" %}" href="#"></a>
            {% endif %}
            <a data-rel="edit" data-tooltip="{% trans "Edit plugin" %}" href="#"></a>
            <a data-rel="delete" data-tooltip="{% trans "Delete plugin" %}" href="#"></a>
            <a data-rel="edit-menu" href="#"></a>
            <div class="cms_edit-menu-dropdown">
                <div class="cms_edit-menu-item"><a data-rel="cut" href="#">{% trans "Cut" %}</a></div>
                <div class="cms_edit-menu-item"><a data-rel="copy" href="#">{% trans "Copy" %}</a></div>
                <div class="cms_edit-menu-item"><a data-rel="paste" href="#">{% trans "Paste" %}</a></div>
                {% extra_menu_items plugin %}
            </div>
        </div>
	</div>
	{% if plugin.get_plugin_class.allow_children %}<div class="cms_draggables">{% endif %}
	{% if plugin.get_plugin_class.allow_children and plugin.num_children == 0 %}
		{# <div class="cms_reset cms_draggable cms_draggable-empty"><div class="cms_dragitem">{% trans "Drop a plugin here" %}</div></div> #}
	{% endif %}
	{% if plugin.child_plugin_instances %}
		{% for child in plugin.child_plugin_instances %}
			{# workaround because include tag does not allow recursive includes #}
			{% with template_name="cms/toolbar/dragitem.html" %}{% include template_name with plugin=child %}{% endwith %}
		{% endfor %}
	{% endif %}
	{% if plugin.get_plugin_class.allow_children %}</div>{% endif %}{% endlanguage %}
</div>
